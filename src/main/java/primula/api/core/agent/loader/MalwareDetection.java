package primula.api.core.agent.loader;

import java.util.Arrays;
import java.util.List;

import com.sun.jna.Library;
import com.sun.jna.Pointer;
import com.sun.jna.Structure;


public interface MalwareDetection extends Library{
	public class result extends Structure{
		public static class ByValue extends result implements Structure.ByValue {}
		public static class ByReference extends result implements Structure.ByReference{}
		public String virname;
		public double size;
		protected List<String> getFieldOrder() {
			return Arrays.asList("virname","size");
		}
		public result(){
			super();
		}
		public result(Pointer p){
			super();
			useMemory(p);
			read();
		}	
	}	
	public int dbunpack(String file,String dir);
	public int cdiff_add(String file,String dir);
	public int dbbuild(String tdir,String newdb,String dbname,String dbdir,String db);
	public int scanfile(String path,String base,result.ByReference res);
	public void result_free(result.ByReference res);

}
